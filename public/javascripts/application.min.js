/* Notes!Notes!Notes! 11-29-2013 */
function setConstants(){"use strict";constants.num=1024,constants.delay=1,constants.color="rgb(9, 74, 178)",constants.r=5,constants.size=95,constants.numVis=7,constants.numToSkip=constants.num/32}function initDotsArray(){"use strict";var a,b=2*Math.PI/constants.num;for(a=0;a<constants.num;a+=1)dots[a]={x:Math.cos(a*b-Math.PI/2),y:Math.sin(a*b-Math.PI/2),r:constants.r,name:"dot"+a}}function appendSpinner(){"use strict";var a=document.createElementNS("http://www.w3.org/2000/svg","g"),b=document.getElementById("coordinateFrame");return a.id="spinner",b.appendChild(a),a}function appendDot(a,b){"use strict";var c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.id=a.name,c.cx.baseVal.value=a.x*constants.size,c.cy.baseVal.value=a.y*constants.size,c.r.baseVal.value=a.r,c.style.fill=constants.color,c.style.opacity=0,b.appendChild(c)}function loadDots(){"use strict";var a;for(a=0;a<dots.length;a+=1)dots[a].obj=document.getElementById(dots[a].name)}function doAnim(){"use strict";var a,b,c=constants.numVis,d=1/c,e=constants.numToSkip,f=0;for(dots[curDot].obj.style.opacity=1,a=1;c*e+1>=a;a++)b=curDot-a,0>b&&(b=constants.num+b),a%e!==0?dots[b].obj.style.opacity=0:(dots[b].obj.style.opacity=1-d*f,f++);++curDot>=constants.num&&(curDot=0)}function initSpinner(){"use strict";var a,b=appendSpinner(),c=document.getElementById("svgElem"),d=(window.innerWidth-$("#sidebar").width())/2-(constants.size+constants.r)/2,e=20;for(setConstants(),initDotsArray(),a=0;a<dots.length;a+=1)appendDot(dots[a],b);c.style.position="absolute",c.style.left=d,c.style.top=e,loadDots(),timer=setInterval(doAnim,constants.delay),curDot=0}function stopAnim(){"use strict";clearInterval(timer)}function setConstants(){"use strict";constants.num=1024,constants.delay=1,constants.color="rgb(9, 74, 178)",constants.r=5,constants.size=95,constants.numVis=7,constants.numToSkip=constants.num/32}function initDotsArray(){"use strict";var a,b=2*Math.PI/constants.num;for(a=0;a<constants.num;a+=1)dots[a]={x:Math.cos(a*b-Math.PI/2),y:Math.sin(a*b-Math.PI/2),r:constants.r,name:"dot"+a}}function appendSpinner(){"use strict";var a=document.createElementNS("http://www.w3.org/2000/svg","g"),b=document.getElementById("coordinateFrame");return a.id="spinner",b.appendChild(a),a}function appendDot(a,b){"use strict";var c=document.createElementNS("http://www.w3.org/2000/svg","circle");c.id=a.name,c.cx.baseVal.value=a.x*constants.size,c.cy.baseVal.value=a.y*constants.size,c.r.baseVal.value=a.r,c.style.fill=constants.color,c.style.opacity=0,b.appendChild(c)}function loadDots(){"use strict";var a;for(a=0;a<dots.length;a+=1)dots[a].obj=document.getElementById(dots[a].name)}function doAnim(){"use strict";var a,b,c=constants.numVis,d=1/c,e=constants.numToSkip,f=0;for(dots[curDot].obj.style.opacity=1,a=1;c*e+1>=a;a++)b=curDot-a,0>b&&(b=constants.num+b),a%e!==0?dots[b].obj.style.opacity=0:(dots[b].obj.style.opacity=1-d*f,f++);++curDot>=constants.num&&(curDot=0)}function initSpinner(){"use strict";var a,b=appendSpinner(),c=document.getElementById("svgElem"),d=(window.innerWidth-$("#sidebar").width())/2-(constants.size+constants.r)/2,e=20;for(setConstants(),initDotsArray(),a=0;a<dots.length;a+=1)appendDot(dots[a],b);c.style.position="absolute",c.style.left=d,c.style.top=e,loadDots(),timer=setInterval(doAnim,constants.delay),curDot=0}function stopAnim(){"use strict";clearInterval(timer)}var constants={},dots=[],timer,curDot,beResponsive=function(){"use strict";for(var a=$("div#nHidden").children(),b=$("div#nContainer"),c=window.innerWidth,d=a.length,e=Math.floor((c-140)/200),f=Math.ceil(d/e),g=0;f>g;g++)for(var h=0;e>h&&d>=g*e+h;h++){var i=$(a[g*e+h]);i.css({left:200*h+20,top:80*g+10}),b.append(i)}},initSearch=function(){"use strict";var a=$("#hiddenSpinner").remove().html();$("#searchBox").on("submit",function(){console.log(a),$("#mainContent").html(a),initSpinner();var b=$("#searchField").val(),c=$("#searchField").action;$.ajax(c,{type:"GET",data:b,success:renderSearch()})})},initShare=function(){"use strict";$("#item_to_share").bind("click",function(){var a=window.confirm("Choose new notebook to share?");a&&window.location.replace("/selectNotebook")}),$("#save_button").bind("click",function(){window.location.replace("/share")})},itemSelect=function(){"use strict";$(".searchResult").click(function(){$(this).toggleClass("highlighted");var a=$(this).find(".checkbox");if(a.prop("checked",!a.prop("checked")),window.location.href.indexOf("home")>-1)if(1===$(".highlighted").length){$(".hmenu").css({visibility:"visible"}),$("#open").removeClass("disabled");var b="/"+$(".highlighted")[0].id+"/SelectedNotebook";$("#link").prop("href",b)}else $(".highlighted").length>1?($("#open").addClass("disabled"),$("#link").removeAttr("href")):0===$(".highlighted").length&&($(".hmenu").css({visibility:"hidden"}),$("#open").removeClass("disabled"));if(window.location.href.indexOf("Selected")>-1)if(1===$(".highlighted").length){$(".hmenu").css({visibility:"visible"}),$(".smenu").css({visibility:"visible"}),$(".smenu").removeClass("disabled");var b="/"+$(".highlighted")[0].id+"/edit";$(".links").prop("href",b)}else $(".highlighted").length>1?($(".smnenu").addClass("disabled"),$(".links").removeAttr("href")):0===$(".highlighted").length&&($(".hmenu").css({visibility:"hidden"}),$(".smenu").css({visibility:"hidden"}),$(".links").removeClass("disabled"))})},renderSearch=function(){"use strict";beResponsive()};$(function(){"use strict";beResponsive(),initSearch(),initShare(),itemSelect()});var constants={},dots=[],timer,curDot,beResponsive=function(){"use strict";for(var a=$("div#nHidden").children(),b=$("div#nContainer"),c=window.innerWidth,d=a.length,e=Math.floor((c-140)/200),f=Math.ceil(d/e),g=0;f>g;g++)for(var h=0;e>h&&d>=g*e+h;h++){var i=$(a[g*e+h]);i.css({left:200*h+20,top:80*g+10}),b.append(i)}},initSearch=function(){"use strict";var a=$("#hiddenSpinner").remove().html();$("#searchBox").on("submit",function(){console.log(a),$("#mainContent").html(a),initSpinner();var b=$("#searchField").val(),c=$("#searchField").action;$.ajax(c,{type:"GET",data:b,success:renderSearch()})})},initShare=function(){"use strict";$("#item_to_share").bind("click",function(){var a=window.confirm("Choose new notebook to share?");a&&window.location.replace("/selectNotebook")}),$("#save_button").bind("click",function(){window.location.replace("/share")})},itemSelect=function(){"use strict";$(".searchResult").click(function(){$(this).toggleClass("highlighted");var a=$(this).find(".checkbox");if(a.prop("checked",!a.prop("checked")),window.location.href.indexOf("home")>-1)if(1===$(".highlighted").length){$(".hmenu").css({visibility:"visible"}),$("#open").removeClass("disabled");var b="/"+$(".highlighted")[0].id+"/SelectedNotebook";$("#link").prop("href",b)}else $(".highlighted").length>1?($("#open").addClass("disabled"),$("#link").removeAttr("href")):0===$(".highlighted").length&&($(".hmenu").css({visibility:"hidden"}),$("#open").removeClass("disabled"));if(window.location.href.indexOf("Selected")>-1)if(1===$(".highlighted").length){$(".hmenu").css({visibility:"visible"}),$(".smenu").css({visibility:"visible"}),$(".smenu").removeClass("disabled");var b="/"+$(".highlighted")[0].id+"/edit";$(".links").prop("href",b)}else $(".highlighted").length>1?($(".smnenu").addClass("disabled"),$(".links").removeAttr("href")):0===$(".highlighted").length&&($(".hmenu").css({visibility:"hidden"}),$(".smenu").css({visibility:"hidden"}),$(".links").removeClass("disabled"))})},renderSearch=function(){"use strict";beResponsive()};$(function(){"use strict";beResponsive(),initSearch(),initShare(),itemSelect()}),$(function(){"use strict";function a(a,b,c){$.ajax({type:"POST",url:b,data:{data:a}}).done(function(a){c(a)})}function b(){a("","share/edit",function(a){$("#sharedList").html("");var b,c="";for(b=0;b<a.length;b++)c=c+'<li class="sharedData">'+a[b].name+" <br>",c+=a[b].canEdit===!0?"Can Edit </li>":"Can View </li>",c+="<br>";return $("#sharedList").html(c),!1})}function c(){$(".searchData").bind("click",function(){var a=$(this),b=a.attr("class");$(".selected").each(function(){$(this).removeClass("selected")}),"searchData selected"!==b&&a.addClass("selected")}),$("#search_view_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/canViewChange",function(){a(c,"/share/addUser",function(){$("#search_results_div").html(""),b()})})}),$("#search_edit_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/canEditChange",function(){a(c,"/share/addUser",function(){$("#search_results_div").html(""),b()})})}),$("#allow_edit_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/canEditChange",function(){b(),d()})}),$("#allow_view_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/canViewChange",function(){b(),d()})}),$("#delete_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/deleteUser",function(){b(),d()})})}function d(){a("","share/edit",function(a){var d='<h2 id="edit_results_header"> Edit: </h2><button type="submit" id="delete_button" class="btn btn-primary">Delete!</button>';d+='<button type="submit" id="allow_edit_button" class="btn btn-primary">User can edit</button>',d+='<button type="submit" id="allow_view_button" class="btn btn-primary">User can view only</button><table id="edit_results">';for(var e=0;e<a.length;e++)d=d+'<tr id="'+a[e].userid+'" class="searchData">',d=d+"<td>"+a[e].userid+"</td>",d=d+"<td>"+a[e].name+"</td>",d=d+"<td>"+a[e].email+"</td>",d+=a[e].canEdit===!0?"<td>Can Edit</td>":"<td>Can View</td>",d+="</tr>";return d+="</table></div>",$("#edit_results_div").html(d),b(),c(),!1})}function e(){$("#search_form").bind("submit",function(b){b.preventDefault();var d=$("#share-email").val();$("#edit_results_div").html(""),a(d,"share/search",function(a){var b,d='<h2 id="search_results_header"> Search Results: </h2>';for(d+='<button type="submit" id="search_edit_button" class="btn btn-primary">User can edit</button>',d+='<button type="submit" id="search_view_button" class="btn btn-primary">User can view only</button><table id="search_results">',b=0;b<a.length;b++)d=d+'<tr id="'+a[b].userid+'" class="searchData">',d=d+'<td class="uid">'+a[b].userid+"</td>",d=d+"<td>"+a[b].name+"</td>",d=d+"<td>"+a[b].email+"</td>",d+="</tr>";return d+="</table></div>",$("#search_results_div").html(d),$("input").val(""),c(),!1})})}function f(){$("#edit_button").bind("click",function(){$("#search_results_div").html(""),d()})}e(),f()}),$(document).ready(function(){function a(a,b,c){$.ajax({type:"POST",url:b,data:{_id:a}}).done(function(a){e=a,c(a)})}function b(a,b,c){$.ajax({type:"POST",url:b,data:{data:a}}).done(function(a){c(a)})}function c(){a(id,"/getnotebook",function(a){console.log(a),$(".header").html(a.title+" Notebook"),$("#t").html(a.title+" Notebook")}),d()}function d(){console.log(id),b(id,"/grabnotes",function(a){console.log("note "+a.notebookId),console.log(a);var b='<div id="nHidden" style="display:none;"><div class="searchResult" id="'+a._id+'"><a href="#"><span class="hoverWrapper"><span class="itemTile"><span class="noteIcon"><img src="/images/noteIcon.png"/>	<span class="namePlate">'+a.title+'</span></span><span class="selectBox"><input type="checkbox" class="checkbox"/><label></label></span></span></span></a></div>';$(".content").html(b)})}var e;c()}),$(document).ready(function(){function a(a){$.ajax({type:"POST",url:"/update",data:{doc:a}}).done(function(a){d=a})}function b(a){h.text(a.title),f.setContent(a.note)}function c(){var c=0;g.bind("keyup",function(){d.note=f.getContent(),j.emit("doc_change",d),c++,console.log(c),10==c&&(a(d),c=0)}),h.bind("click",function(){$(this).hide(),i.attr("value",$(this).text()),i.show()}),i.bind("keydown",function(c){return 13==c.which?($(this).hide(),d.title=$(this).val(),b(d),h.show(),a(d),j.emit("doc_change",d),!1):void 0})}var d,e=(new nicEditor).panelInstance("text-editor"),f=e.instanceById("text-editor"),g=$("div.nicEdit-main "),h=$("#title"),i=$("#title_input");$.ajax({type:"POST",url:"/getnote",data:{_id:id}}).done(function(a){console.log("Got document"),console.log(a),d=a,b(d)});var j=io.connect();j.on("connect",function(){j.on("view_update",function(a){console.log("wut"),b(a)})}),c()}),$(document).ready(function(){var a,b=$("#text"),c=$("#title"),d=io.connect();$.ajax({type:"POST",url:"/getnote",data:{_id:id}}).done(function(d){console.log("Got document"),a=d,b.html(a.note),c.text(a.title)}),d.on("connect",function(){d.on("view_update",function(a){b.html(a.note),c.text(a.title)})})}),$(function(){"use strict";function a(a,b,c){$.ajax({type:"POST",url:b,data:{data:a}}).done(function(a){c(a)})}function b(){a("","share/edit",function(a){$("#sharedList").html("");var b,c="";for(b=0;b<a.length;b++)c=c+'<li class="sharedData">'+a[b].name+" <br>",c+=a[b].canEdit===!0?"Can Edit </li>":"Can View </li>",c+="<br>";return $("#sharedList").html(c),!1})}function c(){$(".searchData").bind("click",function(){var a=$(this),b=a.attr("class");$(".selected").each(function(){$(this).removeClass("selected")}),"searchData selected"!==b&&a.addClass("selected")}),$("#search_view_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/canViewChange",function(){a(c,"/share/addUser",function(){$("#search_results_div").html(""),b()})})}),$("#search_edit_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/canEditChange",function(){a(c,"/share/addUser",function(){$("#search_results_div").html(""),b()})})}),$("#allow_edit_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/canEditChange",function(){b(),d()})}),$("#allow_view_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/canViewChange",function(){b(),d()})}),$("#delete_button").bind("click",function(){var c=$(".selected").attr("id");a(c,"/share/deleteUser",function(){b(),d()})})}function d(){a("","share/edit",function(a){var d='<h2 id="edit_results_header"> Edit: </h2><button type="submit" id="delete_button" class="btn btn-primary">Delete!</button>';d+='<button type="submit" id="allow_edit_button" class="btn btn-primary">User can edit</button>',d+='<button type="submit" id="allow_view_button" class="btn btn-primary">User can view only</button><table id="edit_results">';for(var e=0;e<a.length;e++)d=d+'<tr id="'+a[e].userid+'" class="searchData">',d=d+"<td>"+a[e].userid+"</td>",d=d+"<td>"+a[e].name+"</td>",d=d+"<td>"+a[e].email+"</td>",d+=a[e].canEdit===!0?"<td>Can Edit</td>":"<td>Can View</td>",d+="</tr>";return d+="</table></div>",$("#edit_results_div").html(d),b(),c(),!1})}function e(){$("#search_form").bind("submit",function(b){b.preventDefault();var d=$("#share-email").val();$("#edit_results_div").html(""),a(d,"share/search",function(a){var b,d='<h2 id="search_results_header"> Search Results: </h2>';for(d+='<button type="submit" id="search_edit_button" class="btn btn-primary">User can edit</button>',d+='<button type="submit" id="search_view_button" class="btn btn-primary">User can view only</button><table id="search_results">',b=0;b<a.length;b++)d=d+'<tr id="'+a[b].userid+'" class="searchData">',d=d+'<td class="uid">'+a[b].userid+"</td>",d=d+"<td>"+a[b].name+"</td>",d=d+"<td>"+a[b].email+"</td>",d+="</tr>";return d+="</table></div>",$("#search_results_div").html(d),$("input").val(""),c(),!1})})}function f(){$("#edit_button").bind("click",function(){$("#search_results_div").html(""),d()})}e(),f()}),$(document).ready(function(){function a(a,b,c){$.ajax({type:"POST",url:b,data:{_id:a}}).done(function(a){e=a,c(a)})}function b(a,b,c){$.ajax({type:"POST",url:b,data:{data:a}}).done(function(a){c(a)})}function c(){a(id,"/getnotebook",function(a){console.log(a),$(".header").html(a.title+" Notebook"),$("#t").html(a.title+" Notebook")}),d()}function d(){console.log(id),b(id,"/grabnotes",function(a){console.log("note "+a.notebookId),console.log(a);var b='<div id="nHidden" style="display:none;"><div class="searchResult" id="'+a._id+'"><a href="#"><span class="hoverWrapper"><span class="itemTile"><span class="noteIcon"><img src="/images/noteIcon.png"/>	<span class="namePlate">'+a.title+'</span></span><span class="selectBox"><input type="checkbox" class="checkbox"/><label></label></span></span></span></a></div>';$(".content").html(b)})}var e;c()}),$(document).ready(function(){function a(a){$.ajax({type:"POST",url:"/update",data:{doc:a}}).done(function(a){d=a})}function b(a){h.text(a.title),f.setContent(a.note)}function c(){var c=0;g.bind("keyup",function(){d.note=f.getContent(),j.emit("doc_change",d),c++,console.log(c),10==c&&(a(d),c=0)}),h.bind("click",function(){$(this).hide(),i.attr("value",$(this).text()),i.show()}),i.bind("keydown",function(c){return 13==c.which?($(this).hide(),d.title=$(this).val(),b(d),h.show(),a(d),j.emit("doc_change",d),!1):void 0})}var d,e=(new nicEditor).panelInstance("text-editor"),f=e.instanceById("text-editor"),g=$("div.nicEdit-main "),h=$("#title"),i=$("#title_input");$.ajax({type:"POST",url:"/getnote",data:{_id:id}}).done(function(a){console.log("Got document"),console.log(a),d=a,b(d)});var j=io.connect();j.on("connect",function(){j.on("view_update",function(a){console.log("wut"),b(a)})}),c()}),$(document).ready(function(){var a,b=$("#text"),c=$("#title"),d=io.connect();$.ajax({type:"POST",url:"/getnote",data:{_id:id}}).done(function(d){console.log("Got document"),a=d,b.html(a.note),c.text(a.title)}),d.on("connect",function(){d.on("view_update",function(a){b.html(a.note),c.text(a.title)})})});